<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bet: Heartbeat Protocol</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Bet"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d3/dfd/md_docs_protocol_heartbeat_protocol.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Heartbeat Protocol </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>As the name suggests, this protocol periodically checks and updates the every node in the game aout the status of all other nodes in the game. It's specially useful in identifying the scenarios where a player gets disconnected due to any of the reasons and based on this information <code>dealer</code> will wait for some pre-defined <code>threshold time</code> for the player to reconnect and if the player fails to reconnect with in that threshold time then the <code>dealer</code> considers the player move as <code>drop</code> and consider continuing the game with the rest of the active players on the game.</p>
<h1><a class="anchor" id="autotoc_md80"></a>
How the protocol works</h1>
<p>As it was defined in the <code>pangea</code> protocol that all the communications in the game must pass through the <code>dealer</code>. In short dealer and all other entities in the game connected using <code>pub-sub</code> sockets over the port <code>7797</code> and <code>pull-push</code> sockets over the port <code>7798</code>.</p>
<p>The <code>dealer</code> publishes the <code>beacon</code> messages periodically at the intervals of defined <code>threshold_time</code>, here at the moment <code>threshold_time</code> is defined as <code>30 seconds</code> so for every <code>30 seconds</code> a <code>beacon</code> message is published.</p>
<p>The format and contents of the <code>beacon</code> message is as follows: </p><div class="fragment"><div class="line">{</div>
<div class="line">        &quot;method&quot;:       &quot;live&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p> The <code>playing nodes</code> and the <code>bvv</code> responds with the status, if the <code>dcv</code> didn't get any response from any of the node within the <code>threshold_time</code> then <code>dcv</code> assumes that the corresponding node got disconnected.</p>
<p>The response message from <code>bvv</code> is as follows: </p><div class="fragment"><div class="line">{</div>
<div class="line">        &quot;method&quot;:       &quot;live&quot;,</div>
<div class="line">        &quot;node_type&quot;:    &quot;bvv&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">Note: The heartbeat protocol gets triggered when the table is filled, it means by then each joined player in the game is associated with the playerid. For that reason you can see playerid in the response message from the player</div>
</div><!-- fragment --><p>The response message from the <code>player</code> is as follows: </p><div class="fragment"><div class="line">{</div>
<div class="line">        &quot;method&quot;:       &quot;live&quot;,</div>
<div class="line">        &quot;node_type&quot;:    &quot;player&quot;,</div>
<div class="line">        &quot;playerid&quot;:     1</div>
<div class="line">}</div>
</div><!-- fragment --><p>After summarizing the responses from all the nodes, <code>dcv</code> publishes the <code>status_info</code>. The contents of the <code>status_info</code> is as follows: </p><div class="fragment"><div class="line">{</div>
<div class="line">        &quot;method&quot;:       &quot;status_info&quot;,</div>
<div class="line">        &quot;bvv_status&quot;:   1,</div>
<div class="line">        &quot;no_of_players&quot;:        2,</div>
<div class="line">        &quot;players_status&quot;:       [1, 1]</div>
<div class="line">}</div>
</div><!-- fragment --><p> The same <code>status_info</code> is forwarded to the respective GUI from the corresponding player node backends. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jul 22 2021 18:33:23 for Bet by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
